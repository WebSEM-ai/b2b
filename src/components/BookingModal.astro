---
interface Props {
    title?: string;
    subtitle?: string;
    calendlyUrl?: string;
}

const {
    title = 'Programează o Consultație',
    subtitle = 'Alege un slot care ți se potrivește',
    calendlyUrl = 'https://calendly.com/websem/audit'
} = Astro.props;
---

<div class="booking-modal" id="booking-modal">
    <div class="modal-backdrop" id="modal-backdrop"></div>
    <div class="modal-content">
        <button class="modal-close" id="modal-close" aria-label="Close modal">×</button>
        <div class="modal-header">
            <h3>{title}</h3>
            <p>{subtitle}</p>
        </div>
        <div class="modal-body">
            <!-- Calendly iframe or custom form -->
            <iframe
                src={calendlyUrl}
                title="Calendly Scheduling"
                loading="lazy"
            ></iframe>
        </div>
    </div>
</div>

<script>
    // Close modal functionality
    const modal = document.getElementById('booking-modal');
    const backdrop = document.getElementById('modal-backdrop');
    const closeBtn = document.getElementById('modal-close');

    function closeModal() {
        modal?.classList.remove('active');
        document.body.classList.remove('modal-open');
    }

    backdrop?.addEventListener('click', closeModal);
    closeBtn?.addEventListener('click', closeModal);

    // Close on Escape key
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal?.classList.contains('active')) {
            closeModal();
        }
    });
</script>

<style>
    .modal-body {
        padding: 0;
    }

    .modal-body iframe {
        width: 100%;
        height: 550px;
        border: none;
    }

    @media (max-width: 768px) {
        .modal-body iframe {
            height: 450px;
        }
    }
</style>
