---
interface Stat {
    value: string;
    suffix?: string;
    label: string;
    description?: string;
}

interface Props {
    title?: string;
    subtitle?: string;
    stats?: Stat[];
}

const {
    title = 'Rezultate Dovedite',
    subtitle = 'Cifre care vorbesc de la sine',
    stats = [
        { value: '265', suffix: 'M+', label: 'Contacte B2B', description: 'Bază de date verificată' },
        { value: '98', suffix: '%', label: 'Acuratețe Date', description: 'Emailuri validate' },
        { value: '100', suffix: '%', label: 'GDPR Compliant', description: 'Conform legislației UE' },
        { value: '72', suffix: 'h', label: 'Time to Launch', description: 'De la brief la execuție' }
    ]
} = Astro.props;
---

<section class="stats-section" id="advantages">
    <div class="stats-section-header">
        <h2>{title}</h2>
        <p>{subtitle}</p>
    </div>
    <div class="stats-grid">
        {stats.map(stat => (
            <div class="stat-item">
                <div class="stat-item-value">
                    <span class="stat-counter" data-target={stat.value}>0</span>{stat.suffix}
                </div>
                <div class="stat-item-label">{stat.label}</div>
                {stat.description && <div class="stat-item-desc">{stat.description}</div>}
            </div>
        ))}
    </div>
</section>

<script>
    // Counter animation
    const counters = document.querySelectorAll('.stat-counter');

    const animateCounter = (counter: Element) => {
        const target = parseInt(counter.getAttribute('data-target') || '0');
        const duration = 2000;
        const start = performance.now();

        const update = (currentTime: number) => {
            const elapsed = currentTime - start;
            const progress = Math.min(elapsed / duration, 1);

            // Easing function
            const easeOut = 1 - Math.pow(1 - progress, 3);
            const current = Math.floor(easeOut * target);

            counter.textContent = current.toString();

            if (progress < 1) {
                requestAnimationFrame(update);
            } else {
                counter.textContent = target.toString();
            }
        };

        requestAnimationFrame(update);
    };

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                animateCounter(entry.target);
                observer.unobserve(entry.target);
            }
        });
    }, { threshold: 0.5 });

    counters.forEach(counter => observer.observe(counter));
</script>

<style>
    .stats-section {
        padding: 5rem 2rem;
        background: var(--black);
        position: relative;
    }

    .stats-section-header {
        text-align: center;
        margin-bottom: 3.5rem;
    }

    .stats-section-header h2 {
        font-family: 'Space Grotesk', sans-serif;
        font-size: 2rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
    }

    .stats-section-header p {
        color: var(--gray-500);
        font-size: 0.95rem;
    }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 1.5rem;
        max-width: 1100px;
        margin: 0 auto;
    }

    .stat-item {
        background: rgba(255, 255, 255, 0.02);
        border: 1px solid rgba(255, 255, 255, 0.06);
        border-radius: 20px;
        padding: 2rem 1.5rem;
        text-align: center;
        transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        position: relative;
        overflow: hidden;
    }

    .stat-item::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(90deg, #667eea, #764ba2);
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .stat-item:hover {
        transform: translateY(-8px);
        border-color: rgba(99, 102, 241, 0.3);
        box-shadow: 0 20px 50px rgba(99, 102, 241, 0.15);
    }

    .stat-item:hover::before {
        opacity: 1;
    }

    .stat-item-value {
        font-family: 'Space Grotesk', sans-serif;
        font-size: 3rem;
        font-weight: 700;
        background: linear-gradient(135deg, #667eea, #a78bfa);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        line-height: 1.1;
        margin-bottom: 0.75rem;
    }

    .stat-item-label {
        font-size: 1rem;
        font-weight: 600;
        color: var(--white);
        margin-bottom: 0.5rem;
    }

    .stat-item-desc {
        font-size: 0.8rem;
        color: var(--gray-500);
        line-height: 1.4;
    }

    @media (max-width: 1024px) {
        .stats-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }

    @media (max-width: 600px) {
        .stats-grid {
            grid-template-columns: 1fr;
            gap: 1rem;
        }

        .stat-item {
            padding: 1.5rem;
        }

        .stat-item-value {
            font-size: 2.5rem;
        }
    }
</style>
